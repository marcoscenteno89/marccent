{"ast":null,"code":"var _jsxFileName = \"/home/marcos/app/marccent/client/src/components/mini-app/minesweeper.js\";\nimport React, { Component, Fragment } from \"react\";\nimport { ThemeContext } from \"../var\";\nimport { PopUp } from \"../inc/inc-classes\";\nimport Select from 'react-select';\nimport \"../../styles/mini-app/Minesweeper.scss\";\nimport { Button, Bomb, RandomNum, Flag } from \"../inc/inc\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass MineSweeper extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onClick = (e, cell) => {\n      if (this.state.gameOver || cell.revealed) return;\n\n      if (!this.state.active) {\n        this.setState({\n          active: true\n        });\n      }\n\n      let newGrid = this.state.grid;\n\n      if (cell.mine) {\n        for (let i of this.state.mineLocation) newGrid[i.x][i.y].revealed = true;\n\n        this.setState({\n          grid: newGrid,\n          gameOver: true\n        });\n      } else {\n        let grid = this.reveal(newGrid, cell.x, cell.y, 0);\n        let count = this.state.revealedCount + grid.newNonMinesCount;\n\n        if (count === 0) {\n          this.setState({\n            gameOver: true,\n            active: false,\n            win: true\n          });\n        } else {\n          this.setState({\n            grid: grid.arr,\n            revealedCount: count\n          });\n        }\n      }\n    };\n\n    this.onContextMenu = (e, cell) => {\n      e.preventDefault();\n\n      if (!this.state.active) {\n        this.setState({\n          active: true\n        });\n      }\n\n      let mineCnt = this.state.mineCount;\n      let newGrid = this.state.grid;\n\n      if (newGrid[cell.x][cell.y].flagged) {\n        newGrid[cell.x][cell.y].flagged = false;\n        mineCnt = mineCnt + 1;\n      } else {\n        if (mineCnt === 0) {\n          alert('No more flags available.');\n          return;\n        }\n\n        newGrid[cell.x][cell.y].flagged = true;\n        mineCnt = mineCnt - 1;\n      }\n\n      this.setState({\n        grid: newGrid,\n        mineCount: mineCnt\n      });\n    };\n\n    this.dificulty = val => {\n      const game = this.createGrid(10, 10, val.value);\n      this.setState({\n        mineCount: val.value,\n        gameOver: false,\n        grid: game.grid,\n        mineLocation: game.mines\n      });\n    };\n\n    this.state = {\n      grid: false,\n      mineLocation: false,\n      mineCount: 15,\n      popup: false,\n      gameOver: false,\n      active: false,\n      win: false,\n      time: 0,\n      revealedCount: 0,\n      help: false\n    };\n    this.getTime = this.getTime.bind(this);\n    this.startOver = this.startOver.bind(this);\n  }\n\n  async componentDidMount() {\n    const game = this.createGrid(10, 10, this.state.mineCount);\n    this.setState({\n      grid: game.grid,\n      mineLocation: game.mines,\n      mineCount: this.state.mineCount,\n      revealedCount: 100 - this.state.mineCount\n    });\n  }\n\n  startOver() {\n    const game = this.createGrid(10, 10, this.state.mineCount);\n    this.setState({\n      gameOver: false,\n      grid: game.grid,\n      mineLocation: game.mines,\n      popup: false,\n      help: false\n    });\n  }\n\n  createGrid(row, col, bombs) {\n    const grid = [];\n    const mines = [];\n    let mineCount = 0;\n\n    for (let x = 0; x < row; x++) {\n      const inner = [];\n\n      for (let y = 0; y < col; y++) {\n        inner.push({\n          mine: false,\n          revealed: false,\n          flagged: false,\n          value: 0,\n          x: x,\n          y: y,\n          id: mineCount\n        });\n        mineCount++;\n      }\n\n      grid.push(inner);\n    }\n\n    let count = 0;\n\n    while (count < bombs) {\n      let x = RandomNum(0, row - 1);\n      let y = RandomNum(0, col - 1);\n\n      if (!grid[x][y]['mine']) {\n        grid[x][y]['mine'] = true;\n        grid[x][y]['value'] = /*#__PURE__*/_jsxDEV(Bomb, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 31\n        }, this);\n        let loc = {\n          x: x,\n          y: y\n        };\n        mines.push(loc);\n        count++;\n      }\n    }\n\n    for (let x = 0; x < row; x++) {\n      for (let y = 0; y < col; y++) {\n        let cell = grid[x][y];\n        if (cell.mine) continue;\n        if (x > 0 && grid[x - 1][y].mine) cell.value++; // TOP\n\n        if (x > 0 && y < col - 1 && grid[x - 1][y + 1].mine) cell.value++; // TOP RIGHT\n\n        if (y < col - 1 && grid[x][y + 1].mine) cell.value++; // RIGHT\n\n        if (x < row - 1 && y < col - 1 && grid[x + 1][y + 1].mine) cell.value++; // BOTTOM RIGHT\n\n        if (x < row - 1 && grid[x + 1][y].mine) cell.value++; // BOTTOM\n\n        if (x < row - 1 && y > 0 && grid[x + 1][y - 1].mine) cell.value++; // BOTTOM LEFT\n\n        if (y > 0 && grid[x][y - 1].mine) cell.value++; // LEFT\n\n        if (x > 0 && y > 0 && grid[x - 1][y - 1].mine) cell.value++; // TOP LEFT\n      }\n    }\n\n    return {\n      grid,\n      mines\n    };\n  }\n\n  reveal(arr, x, y, newNonMinesCount) {\n    if (arr[x][y].revealed) return;\n    let flipped = [];\n    flipped.push(arr[x][y]);\n\n    while (flipped.length !== 0) {\n      let s = flipped.pop();\n\n      if (!s.revealed) {\n        newNonMinesCount--;\n        s.revealed = true;\n      }\n\n      if (s.value !== 0) break;\n\n      if (s.x > 0 && s.y > 0) {\n        // Top - Left\n        let tl = arr[s.x - 1][s.y - 1];\n        if (tl.value === 0 && !tl.revealed) flipped.push(tl);\n      }\n\n      if (s.x < arr.length - 1 && s.y < arr[0].length - 1) {\n        // Bottom - Right\n        let br = arr[s.x + 1][s.y + 1];\n        if (br.value === 0 && !br.revealed) flipped.push(br);\n      }\n\n      if (s.x < arr.length - 1 && s.y > 0) {\n        // Bottom - Left\n        let bl = arr[s.x + 1][s.y - 1];\n        if (bl.value === 0 && !bl.revealed) flipped.push(bl);\n      }\n\n      if (s.x > 0 && s.y < arr[0].length - 1) {\n        // Top - Right\n        let tr = arr[s.x - 1][s.y + 1];\n        if (tr.value === 0 && !tr.revealed) flipped.push(tr);\n      } // single ones\n\n\n      if (s.x > 0) {\n        // Top\n        let top = arr[s.x - 1][s.y];\n        if (top.value === 0 && !top.revealed) flipped.push(top);\n      }\n\n      if (s.x < arr.length - 1) {\n        // Bottom\n        let bottom = arr[s.x + 1][s.y];\n        if (bottom.value === 0 && !bottom.revealed) flipped.push(bottom);\n      }\n\n      if (s.y > 0) {\n        // Left\n        let left = arr[s.x][s.y - 1];\n        if (left.value === 0 && !left.revealed) flipped.push(left);\n      }\n\n      if (s.y < arr[0].length - 1) {\n        // Right\n        let right = arr[s.x][s.y + 1];\n        if (right.value === 0 && !right.revealed) flipped.push(right);\n      } // Start Revealing Items\n\n\n      if (s.x > 0 && s.y > 0 && !arr[s.x - 1][s.y - 1].revealed) {\n        //Top Left Reveal\n        arr[s.x - 1][s.y - 1].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.y > 0 && !arr[s.x][s.y - 1].revealed) {\n        // Left Reveal\n        arr[s.x][s.y - 1].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.x < arr.length - 1 && s.y > 0 && !arr[s.x + 1][s.y - 1].revealed) {\n        //Bottom Left Reveal\n        arr[s.x + 1][s.y - 1].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.x > 0 && !arr[s.x - 1][s.y].revealed) {\n        //Top Reveal\n        arr[s.x - 1][s.y].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.x < arr.length - 1 && !arr[s.x + 1][s.y].revealed) {\n        // Bottom Reveal\n        arr[s.x + 1][s.y].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.x > 0 && s.y < arr[0].length - 1 && !arr[s.x - 1][s.y + 1].revealed) {\n        // Top Right Reveal\n        arr[s.x - 1][s.y + 1].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.y < arr[0].length - 1 && !arr[s.x][s.y + 1].revealed) {\n        //Right Reveal\n        arr[s.x][s.y + 1].revealed = true;\n        newNonMinesCount--;\n      }\n\n      if (s.x < arr.length - 1 && s.y < arr[0].length - 1 && !arr[s.x + 1][s.y + 1].revealed) {\n        // Bottom Right Reveal\n        arr[s.x + 1][s.y + 1].revealed = true;\n        newNonMinesCount--;\n      }\n    }\n\n    return {\n      arr,\n      newNonMinesCount\n    };\n  }\n\n  help() {\n    this.setState({\n      help: true\n    });\n  }\n\n  getTime(time) {\n    this.setState({\n      active: false,\n      gameOver: false,\n      time: time,\n      popup: true\n    }, () => console.log(this.state));\n  }\n\n  render() {\n    if (!this.state.grid) return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 34\n    }, this);\n    const a = this.context.theme;\n    const b = this.state;\n    const container = {\n      paddingTop: '2rem',\n      backgroundColor: a.mode,\n      color: a.rev,\n      alignItems: 'center'\n    };\n    const select = {\n      control: styles => ({ ...styles,\n        backgroundColor: a.mode\n      }),\n      input: styles => ({ ...styles,\n        color: a.rev\n      }),\n      placeholder: styles => ({ ...styles,\n        color: a.rev\n      }),\n      singleValue: (styles, {\n        data\n      }) => ({ ...styles,\n        color: a.rev\n      }),\n      option: (styles, {\n        data,\n        isDisabled,\n        isFocused,\n        isSelected\n      }) => {\n        return { ...styles,\n          color: a.rev,\n          backgroundColor: a.mode\n        };\n      }\n    };\n    const op = [{\n      label: 'Easy',\n      value: 10\n    }, {\n      label: 'Medium',\n      value: 15\n    }, {\n      label: 'Hard',\n      value: 20\n    }, {\n      label: 'Extra Hard',\n      value: 25\n    }];\n    const btn = {\n      marginTop: '0.7rem',\n      backgroundColor: a.rev,\n      color: a.mode\n    };\n    const background = `container flex-col${a.glass ? ' glass' : ''}`;\n    const header = b.win ? 'Winner' : 'Game Over';\n    return /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"minesweeper flex-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: background,\n        style: container,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Mine Sweeper\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"board\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"status flex-row\",\n            children: [/*#__PURE__*/_jsxDEV(Select, {\n              options: op,\n              styles: select,\n              defaultValue: op[1],\n              className: \"select-field\",\n              onChange: val => this.dificulty(val)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              data: a,\n              children: [/*#__PURE__*/_jsxDEV(Flag, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 29\n              }, this), \" \", b.mineCount]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: a.rev\n              },\n              className: \"counter\",\n              children: /*#__PURE__*/_jsxDEV(Counter, {\n                getTime: this.getTime,\n                active: b.active,\n                data: a,\n                gameOver: b.gameOver\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"body\",\n            children: b.grid.map((row, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bd-col\",\n              children: [\" \", row.map(cell => /*#__PURE__*/_jsxDEV(Cell, {\n                cell: cell,\n                data: a,\n                onClick: this.onClick,\n                onContextMenu: this.onContextMenu\n              }, cell.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 25\n              }, this))]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"controller flex-center\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn\",\n              styles: btn,\n              onClick: () => this.startOver(),\n              text: \"Start Over\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn\",\n              styles: btn,\n              onClick: () => this.help(),\n              text: \"Help\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(PopUp, {\n            header: header,\n            controller: this.startOver,\n            display: b.popup,\n            btnText: \"Start Over\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: b.win ? `Time: ${b.time}` : 'You Lost'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 15\n            }, this)\n          }, 1, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(PopUp, {\n            header: \"Mine Sweeper Instructions\",\n            display: b.help,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"help\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"About the Game\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 381,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"The object of Minesweeper is to expose all the open areas on the board without hitting an bombs.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Instructions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Click \\\"Play\\\" to begin the game.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Use the left click button on the mouse to select a space on the grid. If you hit a bomb, you lose.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"The numbers on the board represent how many bombs are adjacent to a square. For example, if a square has a \\\"3\\\" on it, then there are 3 bombs next to that square. The bombs could be above, below, right left, or diagonal to the square.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Avoid all the bombs and expose all the empty spaces to win Minesweeper.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Tip: Use the numbers to determine where you know a bomb is.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 388,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Tip: You can right click a square with the mouse to place a flag where you think a bomb is. This allows you to avoid that spot.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 389,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 380,\n              columnNumber: 19\n            }, this)\n          }, 2, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nMineSweeper.contextType = ThemeContext;\n\nclass Counter extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      count: 0,\n      active: false\n    };\n  }\n\n  UNSAFE_componentWillReceiveProps(e) {\n    if (e.active && this.state.count === 0) {\n      this.setState({\n        active: true\n      }, () => {\n        this.timer = setInterval(() => this.setState({\n          count: this.state.count + 1\n        }), 1000);\n      });\n    }\n\n    if (e.gameOver) {\n      let temp = this.state.count;\n      clearInterval(this.timer);\n      this.setState({\n        count: 0,\n        active: false\n      }, () => e.getTime(temp));\n    }\n  }\n\n  render() {\n    if (this.context.theme.id === 0) return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 45\n    }, this);\n    return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-stopwatch\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 9\n      }, this), \" \", this.state.count]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nCounter.contextType = ThemeContext;\n\nclass Cell extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: this.props.data,\n      cell: this.props.cell\n    };\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    this.setState({\n      data: props.data,\n      cell: props.cell\n    });\n  }\n\n  bgStart(a, e) {\n    e.target.style.background = a.grad;\n  }\n\n  bgLeave(a, e) {\n    e.target.style.background = a.mode;\n  }\n\n  render() {\n    if (!this.props.data) return /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Error\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 35\n    }, this);\n    const a = this.props.data;\n    const styles = {\n      backgroundImage: `radial-gradient(${a.hex.secondary} 15%, ${a.hex.primary} 60%)`,\n      color: a.rev\n    };\n    let value = '';\n\n    if (this.state.cell.flagged) {\n      value = /*#__PURE__*/_jsxDEV(Flag, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 474,\n        columnNumber: 15\n      }, this);\n    } else if (this.state.cell.revealed) {\n      styles.opacity = '0.7';\n      if (this.state.cell.value !== 0) value = this.state.cell.value;\n    } else {}\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-center digit\",\n      style: styles,\n      onClick: e => this.props.onClick(e, this.state.cell),\n      onContextMenu: e => this.props.onContextMenu(e, this.state.cell),\n      children: value\n    }, this.props.num, false, {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nCell.contextType = ThemeContext;\nexport default MineSweeper;","map":{"version":3,"sources":["/home/marcos/app/marccent/client/src/components/mini-app/minesweeper.js"],"names":["React","Component","Fragment","ThemeContext","PopUp","Select","Button","Bomb","RandomNum","Flag","MineSweeper","constructor","props","onClick","e","cell","state","gameOver","revealed","active","setState","newGrid","grid","mine","i","mineLocation","x","y","reveal","count","revealedCount","newNonMinesCount","win","arr","onContextMenu","preventDefault","mineCnt","mineCount","flagged","alert","dificulty","val","game","createGrid","value","mines","popup","time","help","getTime","bind","startOver","componentDidMount","row","col","bombs","inner","push","id","loc","flipped","length","s","pop","tl","br","bl","tr","top","bottom","left","right","console","log","render","a","context","theme","b","container","paddingTop","backgroundColor","mode","color","rev","alignItems","select","control","styles","input","placeholder","singleValue","data","option","isDisabled","isFocused","isSelected","op","label","btn","marginTop","background","glass","header","map","index","contextType","Counter","UNSAFE_componentWillReceiveProps","timer","setInterval","temp","clearInterval","Cell","bgStart","target","style","grad","bgLeave","backgroundImage","hex","secondary","primary","opacity","num"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport { ThemeContext } from \"../var\";\nimport { PopUp } from \"../inc/inc-classes\";\nimport Select from 'react-select'\nimport \"../../styles/mini-app/Minesweeper.scss\";\nimport { Button, Bomb, RandomNum, Flag } from \"../inc/inc\";\n\nclass MineSweeper extends Component {\n\n  static contextType = ThemeContext;\n  constructor(props) {\n    super(props);\n    this.state = {\n      grid: false,\n      mineLocation: false,\n      mineCount: 15,\n      popup: false,\n      gameOver: false,\n      active: false,\n      win: false,\n      time: 0,\n      revealedCount: 0,\n      help: false\n    }\n    this.getTime = this.getTime.bind(this);\n    this.startOver = this.startOver.bind(this);\n  }\n  async componentDidMount() {\n    const game = this.createGrid(10, 10, this.state.mineCount);\n    this.setState({\n      grid: game.grid,\n      mineLocation: game.mines,\n      mineCount: this.state.mineCount,\n      revealedCount: 100 - this.state.mineCount\n    });\n  }\n\n  onClick = (e, cell) => {\n    if (this.state.gameOver || cell.revealed) return;\n    if (!this.state.active) {\n      this.setState({\n        active: true\n      });\n    }\n    let newGrid = this.state.grid;\n    if (cell.mine) {\n      for(let i of this.state.mineLocation) newGrid[i.x][i.y].revealed = true;\n      this.setState({\n        grid: newGrid,\n        gameOver: true\n      });\n    } else {\n      let grid = this.reveal(newGrid, cell.x, cell.y, 0);\n      let count = this.state.revealedCount + grid.newNonMinesCount;\n      if (count === 0) {\n        this.setState({\n          gameOver: true,\n          active: false,\n          win: true\n        });\n      } else {\n        this.setState({\n          grid: grid.arr,\n          revealedCount: count,\n        });\n      }\n    }\n  }\n\n  onContextMenu = (e, cell) => {\n    e.preventDefault();\n    if (!this.state.active) {\n      this.setState({\n        active: true\n      });\n    }\n    let mineCnt = this.state.mineCount;\n    let newGrid = this.state.grid;\n    if (newGrid[cell.x][cell.y].flagged) {\n      newGrid[cell.x][cell.y].flagged = false;\n      mineCnt = mineCnt + 1;\n    } else {\n      if (mineCnt === 0) {\n        alert('No more flags available.');\n        return;\n      }\n      newGrid[cell.x][cell.y].flagged = true;\n      mineCnt = mineCnt - 1;\n    }\n    this.setState({\n      grid: newGrid,\n      mineCount: mineCnt\n    });\n  }\n\n  startOver() {\n    const game = this.createGrid(10, 10, this.state.mineCount);\n    this.setState({\n      gameOver: false,\n      grid: game.grid,\n      mineLocation: game.mines,\n      popup: false,\n      help: false\n    });\n  }\n\n  createGrid(row, col, bombs) {\n    const grid = []\n    const mines = []\n    let mineCount = 0\n    for (let x = 0; x < row; x++) {\n      const inner = []\n      for (let y = 0; y < col; y++) {\n        inner.push({\n          mine: false,\n          revealed: false,\n          flagged: false,\n          value: 0,\n          x: x,\n          y: y,\n          id: mineCount\n        });\n        mineCount++;\n      }\n      grid.push(inner);\n    }\n\n    let count = 0;\n    while (count < bombs) {\n      let x = RandomNum(0, row - 1);\n      let y = RandomNum(0, col - 1);\n      if (!grid[x][y]['mine']) {\n        grid[x][y]['mine'] = true;\n        grid[x][y]['value'] = <Bomb />;\n        let loc = {x: x, y: y};\n        mines.push(loc);\n        count++;\n      }\n    }\n\n    for (let x = 0; x < row; x++) {\n      for (let y = 0; y < col; y++) {\n        let cell = grid[x][y];\n        if (cell.mine) continue;\n  \n        if (x > 0 && grid[x - 1][y].mine) cell.value++; // TOP\n\n        if (x > 0 && y < col - 1 && grid[x - 1][y + 1].mine) cell.value++; // TOP RIGHT\n\n        if (y < col - 1 && grid[x][y + 1].mine) cell.value++; // RIGHT\n\n        if (x < row - 1 && y < col - 1 && grid[x + 1][y + 1].mine) cell.value++; // BOTTOM RIGHT\n\n        if (x < row - 1 && grid[x + 1][y].mine) cell.value++; // BOTTOM\n\n        if (x < row - 1 && y > 0 && grid[x + 1][y - 1].mine) cell.value++; // BOTTOM LEFT\n\n        if (y > 0 && grid[x][y - 1].mine) cell.value++; // LEFT\n\n        if (x > 0 && y > 0 && grid[x - 1][y - 1].mine) cell.value++; // TOP LEFT\n      }\n    }\n\n    return { grid, mines };\n  }\n\n  reveal(arr, x, y, newNonMinesCount) {\n    if (arr[x][y].revealed) return;\n\n    let flipped = [];\n    flipped.push(arr[x][y]);\n    while (flipped.length !== 0) {\n      let s = flipped.pop();\n  \n      if (!s.revealed) {\n        newNonMinesCount--;\n        s.revealed = true;\n      }\n  \n      if (s.value !== 0) break;\n      \n      if (s.x > 0 && s.y > 0) { // Top - Left\n        let tl = arr[s.x - 1][s.y - 1];\n        if (tl.value === 0 && !tl.revealed) flipped.push(tl);\n      }\n      \n      if (s.x < arr.length - 1 && s.y < arr[0].length - 1) { // Bottom - Right\n        let br = arr[s.x + 1][s.y + 1];\n        if (br.value === 0 && !br.revealed) flipped.push(br);\n      }\n      \n      if (s.x < arr.length - 1 && s.y > 0) { // Bottom - Left\n        let bl = arr[s.x + 1][s.y - 1]; \n        if (bl.value === 0 && !bl.revealed) flipped.push(bl);\n      }\n      \n      if (s.x > 0 && s.y < arr[0].length - 1) { // Top - Right\n        let tr = arr[s.x - 1][s.y + 1]; \n        if (tr.value === 0 && !tr.revealed) flipped.push(tr);\n      }\n      \n      // single ones\n      if (s.x > 0) { // Top\n        let top = arr[s.x - 1][s.y]; \n        if (top.value === 0 && !top.revealed) flipped.push(top);\n      }\n      if (s.x < arr.length - 1) { // Bottom\n        let bottom = arr[s.x + 1][s.y]; \n        if (bottom.value === 0 && !bottom.revealed) flipped.push(bottom);\n      }\n      \n      if (s.y > 0) { // Left\n        let left = arr[s.x][s.y - 1]; \n        if (left.value === 0 && !left.revealed) flipped.push(left);\n      }\n      \n      if (s.y < arr[0].length - 1) { // Right\n        let right = arr[s.x][s.y + 1]; \n        if (right.value === 0 && !right.revealed) flipped.push(right);\n      }\n    \n      // Start Revealing Items\n      if (s.x > 0 && s.y > 0 && !arr[s.x - 1][s.y - 1].revealed) { //Top Left Reveal\n        arr[s.x - 1][s.y - 1].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.y > 0 && !arr[s.x][s.y - 1].revealed) { // Left Reveal\n        arr[s.x][s.y - 1].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.x < arr.length - 1 && s.y > 0 && !arr[s.x + 1][s.y - 1].revealed) { //Bottom Left Reveal\n        arr[s.x + 1][s.y - 1].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.x > 0 && !arr[s.x - 1][s.y].revealed) { //Top Reveal\n        arr[s.x - 1][s.y].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.x < arr.length - 1 && !arr[s.x + 1][s.y].revealed) { // Bottom Reveal\n        arr[s.x + 1][s.y].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.x > 0 && s.y < arr[0].length - 1 && !arr[s.x - 1][s.y + 1].revealed) { // Top Right Reveal\n        arr[s.x - 1][s.y + 1].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.y < arr[0].length - 1 && !arr[s.x][s.y + 1].revealed) { //Right Reveal\n        arr[s.x][s.y + 1].revealed = true;\n        newNonMinesCount--;\n      }\n  \n      if (s.x < arr.length - 1 && s.y < arr[0].length - 1 && !arr[s.x + 1][s.y + 1].revealed) {// Bottom Right Reveal\n        arr[s.x + 1][s.y + 1].revealed = true;\n        newNonMinesCount--;\n      }\n\n    }\n    \n    return { arr, newNonMinesCount };\n  }\n\n  help() {\n    this.setState({\n      help: true\n    });\n  }\n\n  getTime(time) {\n    this.setState({\n      active: false,\n      gameOver: false,\n      time: time,\n      popup: true\n    }, () => console.log(this.state));\n  }\n\n  dificulty = (val) => {\n    const game = this.createGrid(10, 10, val.value);\n    this.setState({\n      mineCount: val.value,\n      gameOver: false,\n      grid: game.grid,\n      mineLocation: game.mines,\n    });\n  }\n\n  render() {\n    if (!this.state.grid) return <Fragment>Loading...</Fragment>\n    const a = this.context.theme;\n    const b = this.state;\n    const container = {\n      paddingTop: '2rem',\n      backgroundColor: a.mode,\n      color: a.rev,\n      alignItems: 'center'\n    }\n    const select = {\n      control: styles => ({ ...styles, backgroundColor: a.mode}),\n      input: styles => ({ ...styles, color: a.rev}),\n      placeholder: styles => ({ ...styles, color: a.rev}),\n      singleValue: (styles, { data }) => ({ ...styles, color: a.rev }),\n      option: (styles, { data, isDisabled, isFocused, isSelected }) => {\n        return {...styles, \n          color: a.rev,\n          backgroundColor: a.mode\n        }\n      }\n    }\n    const op = [\n      {label: 'Easy', value: 10 },\n      {label: 'Medium', value: 15 },\n      {label: 'Hard', value: 20 },\n      {label: 'Extra Hard', value: 25 }\n    ]\n    const btn = {\n      marginTop: '0.7rem',\n      backgroundColor: a.rev,\n      color: a.mode\n    }\n    const background = `container flex-col${a.glass ? ' glass' : ''}`;\n\n    const header = b.win ? 'Winner' : 'Game Over';\n\n    return (\n      <section className=\"minesweeper flex-center\">\n        <div className={background} style={container}>\n          <h2>Mine Sweeper</h2>\n          <div className=\"board\">\n            <div className=\"status flex-row\">\n              <Select \n                options={op}\n                styles={select}\n                defaultValue={op[1]}\n                className=\"select-field\"\n                onChange={(val) => this.dificulty(val)} \n              />\n              <div data={a}><Flag /> {b.mineCount}</div>\n              <div style={{ color: a.rev}} className=\"counter\">\n                <Counter getTime={this.getTime} active={b.active} data={a} gameOver={b.gameOver} />\n              </div>\n            </div>\n            <div className=\"body\">\n                {b.grid.map((row, index) => \n                    <div className=\"bd-col\" key={index}> {row.map((cell) => \n                        <Cell\n                            cell={cell}\n                            key={cell.id}\n                            data={a} \n                            onClick={this.onClick}\n                            onContextMenu={this.onContextMenu}\n                        />\n                    )}\n                    </div>\n                )}\n            </div>\n            <div className=\"controller flex-center\">\n              <Button \n                className=\"btn\" \n                styles={btn} \n                onClick={() => this.startOver()} \n                text=\"Start Over\" \n              />\n              <Button \n                className=\"btn\" \n                styles={btn} \n                onClick={() => this.help()} \n                text=\"Help\" \n              />\n            </div>\n            <PopUp key={1} header={header} controller={this.startOver} display={b.popup} btnText=\"Start Over\">\n              <div>{b.win ? `Time: ${b.time}` : 'You Lost'}</div>\n            </PopUp>\n            <PopUp key={2} header=\"Mine Sweeper Instructions\" display={b.help}>\n                  <div className=\"help\">\n                    <h4>About the Game</h4> \n                    <p>The object of Minesweeper is to expose all the open areas on the board without hitting an bombs.</p>\n                    <h4>Instructions</h4>\n                    <p>Click \"Play\" to begin the game.</p> \n                    <p>Use the left click button on the mouse to select a space on the grid. If you hit a bomb, you lose.</p>\n                    <p>The numbers on the board represent how many bombs are adjacent to a square. For example, if a square has a \"3\" on it, then there are 3 bombs next to that square. The bombs could be above, below, right left, or diagonal to the square.</p>\n                    <p>Avoid all the bombs and expose all the empty spaces to win Minesweeper.</p>\n                    <p>Tip: Use the numbers to determine where you know a bomb is.</p> \n                    <p>Tip: You can right click a square with the mouse to place a flag where you think a bomb is. This allows you to avoid that spot.</p>\n                  </div>\n                </PopUp>\n          </div>\n        </div>\n      </section>\n    )        \n  }\n}\n\nclass Counter extends Component {\n\n  static contextType = ThemeContext;\n  constructor(props) {\n    super(props);\n    this.state = {\n      count: 0,\n      active: false,\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(e) {\n    if (e.active && this.state.count === 0) {\n      this.setState({\n        active: true\n      }, () => {\n        this.timer = setInterval(() => this.setState({count: this.state.count + 1}), 1000);\n      });\n    }\n    if (e.gameOver) {\n      let temp = this.state.count;\n      clearInterval(this.timer);\n      this.setState({\n        count: 0,\n        active: false\n      }, () => e.getTime(temp));\n    }\n  }\n\n  render() {\n    if (this.context.theme.id === 0) return <Fragment>Loading...</Fragment>\n    return  (\n      <Fragment>\n        <i className=\"fas fa-stopwatch\"></i> {this.state.count}\n      </Fragment>\n    )        \n  }\n}\n\nclass Cell extends Component {\n\n  static contextType = ThemeContext;\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: this.props.data,\n      cell: this.props.cell\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    this.setState({\n      data: props.data,\n      cell: props.cell\n    });\n  }\n\n  bgStart(a, e) {\n    e.target.style.background = a.grad;\n  }\n\n  bgLeave(a, e) {\n    e.target.style.background = a.mode;\n  }\n\n  render() {\n    if (!this.props.data) return (<h1>Error</h1>);\n    const a = this.props.data;\n    const styles = {\n      backgroundImage: `radial-gradient(${a.hex.secondary} 15%, ${a.hex.primary} 60%)`,\n      color: a.rev\n    }\n\n    let value = '';\n    if (this.state.cell.flagged) {\n      value = <Flag />\n    } else if (this.state.cell.revealed) {\n      styles.opacity = '0.7';\n      if (this.state.cell.value !== 0) value  = this.state.cell.value;\n    } else {}\n    return  (\n      <div className=\"flex-center digit\" style={styles} \n        onClick={(e) => this.props.onClick(e, this.state.cell)}\n        onContextMenu={(e) => this.props.onContextMenu(e, this.state.cell)}\n        key={this.props.num}> \n          {value} \n      </div>\n    )       \n  }\n}\n\n\nexport default MineSweeper;"]},"metadata":{},"sourceType":"module"}